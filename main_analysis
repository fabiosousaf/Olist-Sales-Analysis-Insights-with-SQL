{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/fabiosantosf/olist-sales-analysis-insights-with-sql?scriptVersionId=269035739\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"4007f08c","metadata":{"execution":{"iopub.execute_input":"2025-10-19T00:23:30.761596Z","iopub.status.busy":"2025-10-19T00:23:30.761272Z","iopub.status.idle":"2025-10-19T00:23:33.7462Z","shell.execute_reply":"2025-10-19T00:23:33.745269Z"},"papermill":{"duration":2.99086,"end_time":"2025-10-19T00:23:33.748165","exception":false,"start_time":"2025-10-19T00:23:30.757305","status":"completed"},"tags":[]},"outputs":[],"source":["import pandas as pd\n","from pandasql import sqldf"]},{"cell_type":"code","execution_count":2,"id":"781b9f09","metadata":{"execution":{"iopub.execute_input":"2025-10-19T00:23:33.754321Z","iopub.status.busy":"2025-10-19T00:23:33.753878Z","iopub.status.idle":"2025-10-19T00:23:35.596152Z","shell.execute_reply":"2025-10-19T00:23:35.595027Z"},"papermill":{"duration":1.846858,"end_time":"2025-10-19T00:23:35.597694","exception":false,"start_time":"2025-10-19T00:23:33.750836","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Carregando arquivos, isso pode levar um momento...\n","Dados carregados com sucesso!\n","As 'tabelas' customers, orders, etc., agora existem e estão prontas para serem usadas.\n"]}],"source":["# Célula 2: Carregando os arquivos de dados para a memória\n","\n","# O caminho '../input/brazilian-ecommerce/' é o padrão do Kaggle para este dataset\n","caminho_dados = '../input/brazilian-ecommerce/'\n","\n","print(\"Carregando arquivos, isso pode levar um momento...\")\n","\n","# Criando as variáveis (que funcionarão como nossas 'tabelas' para o SQL)\n","customers = pd.read_csv(caminho_dados + 'olist_customers_dataset.csv')\n","orders = pd.read_csv(caminho_dados + 'olist_orders_dataset.csv')\n","order_items = pd.read_csv(caminho_dados + 'olist_order_items_dataset.csv')\n","products = pd.read_csv(caminho_dados + 'olist_products_dataset.csv')\n","payments = pd.read_csv(caminho_dados + 'olist_order_payments_dataset.csv')\n","sellers = pd.read_csv(caminho_dados + 'olist_sellers_dataset.csv')\n","\n","print(\"Dados carregados com sucesso!\")\n","print(\"As 'tabelas' customers, orders, etc., agora existem e estão prontas para serem usadas.\")"]},{"cell_type":"markdown","id":"9745e2d6","metadata":{"papermill":{"duration":0.001979,"end_time":"2025-10-19T00:23:35.602107","exception":false,"start_time":"2025-10-19T00:23:35.600128","status":"completed"},"tags":[]},"source":["### Análise Inicial: Qual a Distribuição Geográfica dos Nossos Clentes?"]},{"cell_type":"markdown","id":"63cdc78b","metadata":{"papermill":{"duration":0.001902,"end_time":"2025-10-19T00:23:35.606103","exception":false,"start_time":"2025-10-19T00:23:35.604201","status":"completed"},"tags":[]},"source":["A primeira etapa para entender o negócio é saber onde nossos clientes estão localizados. Esta análise inicial identifica os estados com a maior concentração de clientes, utilizando apenas a tabela *customers*."]},{"cell_type":"code","execution_count":3,"id":"b38c550f","metadata":{"execution":{"iopub.execute_input":"2025-10-19T00:23:35.611764Z","iopub.status.busy":"2025-10-19T00:23:35.611419Z","iopub.status.idle":"2025-10-19T00:23:36.774229Z","shell.execute_reply":"2025-10-19T00:23:36.773143Z"},"papermill":{"duration":1.170925,"end_time":"2025-10-19T00:23:36.779055","exception":false,"start_time":"2025-10-19T00:23:35.60813","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Distribuição de Clientes por Estado\n"]},{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>estado</th>\n","      <th>total_de_clientes</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>SP</td>\n","      <td>41746</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>RJ</td>\n","      <td>12852</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>MG</td>\n","      <td>11635</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>RS</td>\n","      <td>5466</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>PR</td>\n","      <td>5045</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>SC</td>\n","      <td>3637</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>BA</td>\n","      <td>3380</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>DF</td>\n","      <td>2140</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>ES</td>\n","      <td>2033</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>GO</td>\n","      <td>2020</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>PE</td>\n","      <td>1652</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>CE</td>\n","      <td>1336</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>PA</td>\n","      <td>975</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>MT</td>\n","      <td>907</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>MA</td>\n","      <td>747</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>MS</td>\n","      <td>715</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>PB</td>\n","      <td>536</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>PI</td>\n","      <td>495</td>\n","    </tr>\n","    <tr>\n","      <th>18</th>\n","      <td>RN</td>\n","      <td>485</td>\n","    </tr>\n","    <tr>\n","      <th>19</th>\n","      <td>AL</td>\n","      <td>413</td>\n","    </tr>\n","    <tr>\n","      <th>20</th>\n","      <td>SE</td>\n","      <td>350</td>\n","    </tr>\n","    <tr>\n","      <th>21</th>\n","      <td>TO</td>\n","      <td>280</td>\n","    </tr>\n","    <tr>\n","      <th>22</th>\n","      <td>RO</td>\n","      <td>253</td>\n","    </tr>\n","    <tr>\n","      <th>23</th>\n","      <td>AM</td>\n","      <td>148</td>\n","    </tr>\n","    <tr>\n","      <th>24</th>\n","      <td>AC</td>\n","      <td>81</td>\n","    </tr>\n","    <tr>\n","      <th>25</th>\n","      <td>AP</td>\n","      <td>68</td>\n","    </tr>\n","    <tr>\n","      <th>26</th>\n","      <td>RR</td>\n","      <td>46</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["   estado  total_de_clientes\n","0      SP              41746\n","1      RJ              12852\n","2      MG              11635\n","3      RS               5466\n","4      PR               5045\n","5      SC               3637\n","6      BA               3380\n","7      DF               2140\n","8      ES               2033\n","9      GO               2020\n","10     PE               1652\n","11     CE               1336\n","12     PA                975\n","13     MT                907\n","14     MA                747\n","15     MS                715\n","16     PB                536\n","17     PI                495\n","18     RN                485\n","19     AL                413\n","20     SE                350\n","21     TO                280\n","22     RO                253\n","23     AM                148\n","24     AC                 81\n","25     AP                 68\n","26     RR                 46"]},"metadata":{},"output_type":"display_data"}],"source":["query_clientes_por_estado = \"\"\"\n","    SELECT\n","        customer_state AS estado,\n","        COUNT(customer_unique_id) AS total_de_clientes\n","    FROM\n","        customers\n","    GROUP BY\n","        customer_state\n","    ORDER BY\n","        total_de_clientes DESC;\n","\"\"\"\n","\n","# Executando a consulta\n","clientes_por_estado = sqldf(query_clientes_por_estado)\n","\n","# Exibindo o resultado\n","print(\"Distribuição de Clientes por Estado\")\n","display(clientes_por_estado)"]},{"cell_type":"markdown","id":"451e7221","metadata":{"papermill":{"duration":0.002917,"end_time":"2025-10-19T00:23:36.785618","exception":false,"start_time":"2025-10-19T00:23:36.782701","status":"completed"},"tags":[]},"source":["### Insight 2: As Categorias de Produtos Mais Vendidas\n","Nesta análise, vamos identificar as 10 categorias de produtos com maior volume de vendas para entender o foco principal do negócio. Para isso, precisaremos conectar os dados de itens vendidos (`order_items`) com os dados de produtos (`products`)."]},{"cell_type":"code","execution_count":4,"id":"79815fe3","metadata":{"execution":{"iopub.execute_input":"2025-10-19T00:23:36.79517Z","iopub.status.busy":"2025-10-19T00:23:36.794095Z","iopub.status.idle":"2025-10-19T00:23:38.886161Z","shell.execute_reply":"2025-10-19T00:23:38.88524Z"},"papermill":{"duration":2.099037,"end_time":"2025-10-19T00:23:38.887635","exception":false,"start_time":"2025-10-19T00:23:36.788598","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Top 10 Categorias de Produtos Mais Vendidas\n"]},{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>categoria</th>\n","      <th>total_vendido</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>cama_mesa_banho</td>\n","      <td>11115</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>beleza_saude</td>\n","      <td>9670</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>esporte_lazer</td>\n","      <td>8641</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>moveis_decoracao</td>\n","      <td>8334</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>informatica_acessorios</td>\n","      <td>7827</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>utilidades_domesticas</td>\n","      <td>6964</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>relogios_presentes</td>\n","      <td>5991</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>telefonia</td>\n","      <td>4545</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>ferramentas_jardim</td>\n","      <td>4347</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>automotivo</td>\n","      <td>4235</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                categoria  total_vendido\n","0         cama_mesa_banho          11115\n","1            beleza_saude           9670\n","2           esporte_lazer           8641\n","3        moveis_decoracao           8334\n","4  informatica_acessorios           7827\n","5   utilidades_domesticas           6964\n","6      relogios_presentes           5991\n","7               telefonia           4545\n","8      ferramentas_jardim           4347\n","9              automotivo           4235"]},"metadata":{},"output_type":"display_data"}],"source":["query_top_categorias = \"\"\"\n","SELECT \n","    p.product_category_name AS categoria,\n","    COUNT(oi.product_id) AS total_vendido\n","FROM\n","    order_items oi\n","JOIN\n","    products p ON oi.product_id = p.product_id\n","WHERE\n","    p.product_category_name IS NOT NULL\n","GROUP BY\n","    p.product_category_name\n","ORDER BY\n","    total_vendido DESC\n","LIMIT 10;\n","\"\"\"\n","\n","# Executando a consulta\n","top_categorias = sqldf(query_top_categorias)\n","\n","# Exibindo o resultado\n","print(\"Top 10 Categorias de Produtos Mais Vendidas\")\n","display(top_categorias)"]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"datasetId":55151,"sourceId":2669146,"sourceType":"datasetVersion"}],"dockerImageVersionId":31153,"isGpuEnabled":false,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.11.13"},"papermill":{"default_parameters":{},"duration":14.229053,"end_time":"2025-10-19T00:23:39.511324","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-10-19T00:23:25.282271","version":"2.6.0"}},"nbformat":4,"nbformat_minor":5}